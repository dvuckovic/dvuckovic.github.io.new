<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Color calibration and dual monitor setup in Windows 7 | Dusan’s Space</title>
    <meta name="generator" content="VuePress 1.8.2">
    <link rel="icon" href="/favicon.ico">
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600&amp;family=Merriweather+Sans:ital,wght@0,600;1,600&amp;family=Merriweather:ital,wght@0,300;0,400;0,700;1,300;1,400;1,700&amp;display=swap">
    <script async="true" src="https://www.googletagmanager.com/gtag/js?id=G-SJD4XMS3R4"></script>
    <script>window.dataLayer = window.dataLayer || [];
function gtag(){dataLayer.push(arguments);}
gtag('js', new Date());
gtag('config', 'G-SJD4XMS3R4');</script>
    <link rel="alternate" type="application/rss+xml" href="https://dvuckovic.com/rss.xml" title="Dusan’s Space RSS Feed">
    <meta name="description" content="Getting around a buggy system implementation">
    <meta property="article:published_time" content="2011-11-28T00:00:00.000Z">
    <meta property="article:modified_time" content="2021-06-20T12:02:17.000Z">
    <meta property="og:site_name" content="Dusan’s Space">
    <meta property="og:title" content="Color calibration and dual monitor setup in Windows 7">
    <meta property="og:description" content="Getting around a buggy system implementation">
    <meta property="og:type" content="article">
    <meta property="og:url" content="/2011/11/28/color-calibration-and-dual-monitor-setup-windows-7/">
    <meta property="og:image" content="https://cdn.dvuckovic.com/posts/calibration-01_header.jpg">
    <meta name="twitter:title" content="Color calibration and dual monitor setup in Windows 7">
    <meta name="twitter:description" content="Getting around a buggy system implementation">
    <meta name="twitter:url" content="/2011/11/28/color-calibration-and-dual-monitor-setup-windows-7/">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:image" content="https://cdn.dvuckovic.com/posts/calibration-01_header.jpg">
    <meta name="twitter:label2" content="Filed under">
    <meta name="twitter:data2" content="post, windows, script, dtp, color">
    <meta property="article:tag" content="post">
    <meta name="theme-color" content="#ff7700">
    <link rel="preload" href="/assets/css/0.styles.e0e4cea7.css" as="style"><link rel="preload" href="/assets/js/app.7a75f1fe.js" as="script"><link rel="preload" href="/assets/js/19.1346b3bf.js" as="script"><link rel="preload" href="/assets/js/12.e1236284.js" as="script"><link rel="preload" href="/assets/js/38.6c805e13.js" as="script"><link rel="prefetch" href="/assets/js/1.47b44be3.js"><link rel="prefetch" href="/assets/js/10.9100961c.js"><link rel="prefetch" href="/assets/js/100.75b666b5.js"><link rel="prefetch" href="/assets/js/101.b3bbfd39.js"><link rel="prefetch" href="/assets/js/102.cbe66969.js"><link rel="prefetch" href="/assets/js/103.b08a0869.js"><link rel="prefetch" href="/assets/js/104.b4824db2.js"><link rel="prefetch" href="/assets/js/105.e8e6da25.js"><link rel="prefetch" href="/assets/js/106.df067897.js"><link rel="prefetch" href="/assets/js/107.4f834df4.js"><link rel="prefetch" href="/assets/js/108.b9fa77db.js"><link rel="prefetch" href="/assets/js/109.39b66c07.js"><link rel="prefetch" href="/assets/js/11.2d771e9d.js"><link rel="prefetch" href="/assets/js/110.a72e9012.js"><link rel="prefetch" href="/assets/js/111.8f8d0d52.js"><link rel="prefetch" href="/assets/js/112.483c0499.js"><link rel="prefetch" href="/assets/js/113.53a1b0ec.js"><link rel="prefetch" href="/assets/js/114.994e6fc6.js"><link rel="prefetch" href="/assets/js/115.d019b3b3.js"><link rel="prefetch" href="/assets/js/116.7da14914.js"><link rel="prefetch" href="/assets/js/117.354f5fc2.js"><link rel="prefetch" href="/assets/js/118.4bd88bb2.js"><link rel="prefetch" href="/assets/js/119.5bae7b8d.js"><link rel="prefetch" href="/assets/js/120.e909e859.js"><link rel="prefetch" href="/assets/js/121.cc4c1bb4.js"><link rel="prefetch" href="/assets/js/122.e935a102.js"><link rel="prefetch" href="/assets/js/123.bd515f08.js"><link rel="prefetch" href="/assets/js/124.f307495d.js"><link rel="prefetch" href="/assets/js/125.494e6420.js"><link rel="prefetch" href="/assets/js/126.cf0aa04c.js"><link rel="prefetch" href="/assets/js/127.127e1e9d.js"><link rel="prefetch" href="/assets/js/128.a13966fc.js"><link rel="prefetch" href="/assets/js/129.fb9a5055.js"><link rel="prefetch" href="/assets/js/13.4a201018.js"><link rel="prefetch" href="/assets/js/130.0bab81cb.js"><link rel="prefetch" href="/assets/js/131.8d311242.js"><link rel="prefetch" href="/assets/js/132.f67d9af5.js"><link rel="prefetch" href="/assets/js/133.0901673e.js"><link rel="prefetch" href="/assets/js/134.4fd746f6.js"><link rel="prefetch" href="/assets/js/135.48d3c5be.js"><link rel="prefetch" href="/assets/js/136.87d5eb67.js"><link rel="prefetch" href="/assets/js/137.6552c782.js"><link rel="prefetch" href="/assets/js/138.eb4cae8e.js"><link rel="prefetch" href="/assets/js/139.f7100a2e.js"><link rel="prefetch" href="/assets/js/14.1e9f23d3.js"><link rel="prefetch" href="/assets/js/140.e742b946.js"><link rel="prefetch" href="/assets/js/141.9fec0628.js"><link rel="prefetch" href="/assets/js/142.0c3c7ddb.js"><link rel="prefetch" href="/assets/js/143.04245474.js"><link rel="prefetch" href="/assets/js/144.3abcb36c.js"><link rel="prefetch" href="/assets/js/15.ff2cd584.js"><link rel="prefetch" href="/assets/js/16.f4971c4d.js"><link rel="prefetch" href="/assets/js/17.075cedfd.js"><link rel="prefetch" href="/assets/js/18.d792f2ec.js"><link rel="prefetch" href="/assets/js/2.c692d64a.js"><link rel="prefetch" href="/assets/js/20.15be60dc.js"><link rel="prefetch" href="/assets/js/21.c1a7bfa3.js"><link rel="prefetch" href="/assets/js/22.943f67ea.js"><link rel="prefetch" href="/assets/js/23.f431f4d6.js"><link rel="prefetch" href="/assets/js/24.339c4804.js"><link rel="prefetch" href="/assets/js/25.c67844dd.js"><link rel="prefetch" href="/assets/js/26.a52a97e9.js"><link rel="prefetch" href="/assets/js/27.dfbd74dc.js"><link rel="prefetch" href="/assets/js/28.de140592.js"><link rel="prefetch" href="/assets/js/29.de0191f6.js"><link rel="prefetch" href="/assets/js/3.22cfc250.js"><link rel="prefetch" href="/assets/js/30.5ec4efe2.js"><link rel="prefetch" href="/assets/js/31.3b982379.js"><link rel="prefetch" href="/assets/js/32.c6814f82.js"><link rel="prefetch" href="/assets/js/33.e7bb6f69.js"><link rel="prefetch" href="/assets/js/34.9dc51e9f.js"><link rel="prefetch" href="/assets/js/35.113cecc0.js"><link rel="prefetch" href="/assets/js/36.3b4c1524.js"><link rel="prefetch" href="/assets/js/37.514cbc8e.js"><link rel="prefetch" href="/assets/js/39.6a747384.js"><link rel="prefetch" href="/assets/js/40.0c1f511e.js"><link rel="prefetch" href="/assets/js/41.8232996f.js"><link rel="prefetch" href="/assets/js/42.9cc151a3.js"><link rel="prefetch" href="/assets/js/43.ac76176b.js"><link rel="prefetch" href="/assets/js/44.5c73c2ae.js"><link rel="prefetch" href="/assets/js/45.8aa2357a.js"><link rel="prefetch" href="/assets/js/46.d2a10c93.js"><link rel="prefetch" href="/assets/js/47.92d84b19.js"><link rel="prefetch" href="/assets/js/48.5fd68038.js"><link rel="prefetch" href="/assets/js/49.975e7623.js"><link rel="prefetch" href="/assets/js/50.2a526f11.js"><link rel="prefetch" href="/assets/js/51.0b39be9e.js"><link rel="prefetch" href="/assets/js/52.1569c0e2.js"><link rel="prefetch" href="/assets/js/53.357bb5b0.js"><link rel="prefetch" href="/assets/js/54.d2f0ee28.js"><link rel="prefetch" href="/assets/js/55.5a6dce91.js"><link rel="prefetch" href="/assets/js/56.443679dc.js"><link rel="prefetch" href="/assets/js/57.591116bf.js"><link rel="prefetch" href="/assets/js/58.6079e6ab.js"><link rel="prefetch" href="/assets/js/59.10b56410.js"><link rel="prefetch" href="/assets/js/60.2042eab2.js"><link rel="prefetch" href="/assets/js/61.f3d5a99f.js"><link rel="prefetch" href="/assets/js/62.ca93a9e8.js"><link rel="prefetch" href="/assets/js/63.5f72d7fe.js"><link rel="prefetch" href="/assets/js/64.02655094.js"><link rel="prefetch" href="/assets/js/65.ed2d18c4.js"><link rel="prefetch" href="/assets/js/66.04ff7e44.js"><link rel="prefetch" href="/assets/js/67.95f7e57e.js"><link rel="prefetch" href="/assets/js/68.92b2a93f.js"><link rel="prefetch" href="/assets/js/69.7be4992d.js"><link rel="prefetch" href="/assets/js/70.3f9ad26a.js"><link rel="prefetch" href="/assets/js/71.d981d4cf.js"><link rel="prefetch" href="/assets/js/72.6468e54e.js"><link rel="prefetch" href="/assets/js/73.511ae092.js"><link rel="prefetch" href="/assets/js/74.228329eb.js"><link rel="prefetch" href="/assets/js/75.0d8b8262.js"><link rel="prefetch" href="/assets/js/76.e871abb9.js"><link rel="prefetch" href="/assets/js/77.1c43e23d.js"><link rel="prefetch" href="/assets/js/78.a97e55eb.js"><link rel="prefetch" href="/assets/js/79.d3714341.js"><link rel="prefetch" href="/assets/js/80.f5e67788.js"><link rel="prefetch" href="/assets/js/81.424fac9a.js"><link rel="prefetch" href="/assets/js/82.896a47aa.js"><link rel="prefetch" href="/assets/js/83.b23ff087.js"><link rel="prefetch" href="/assets/js/84.8cd76b1e.js"><link rel="prefetch" href="/assets/js/85.74ffdeee.js"><link rel="prefetch" href="/assets/js/86.4e98c5e0.js"><link rel="prefetch" href="/assets/js/87.5842ad2a.js"><link rel="prefetch" href="/assets/js/88.ea409a24.js"><link rel="prefetch" href="/assets/js/89.8e3cfb1e.js"><link rel="prefetch" href="/assets/js/9.73534068.js"><link rel="prefetch" href="/assets/js/90.544ae8d5.js"><link rel="prefetch" href="/assets/js/91.b2bf80c8.js"><link rel="prefetch" href="/assets/js/92.9e37cf18.js"><link rel="prefetch" href="/assets/js/93.d2624e22.js"><link rel="prefetch" href="/assets/js/94.70594964.js"><link rel="prefetch" href="/assets/js/95.fdc05f59.js"><link rel="prefetch" href="/assets/js/96.5a1bf07d.js"><link rel="prefetch" href="/assets/js/97.fcf77cd3.js"><link rel="prefetch" href="/assets/js/98.53ab7c12.js"><link rel="prefetch" href="/assets/js/99.d488142a.js"><link rel="prefetch" href="/assets/js/getag-map.64e16d15.js"><link rel="prefetch" href="/assets/js/vendors~bootstrap.6d48da59.js"><link rel="prefetch" href="/assets/js/vendors~masonry-layout.135896b3.js"><link rel="prefetch" href="/assets/js/vuejs-paginate.9a9ceefc.js">
    <link rel="stylesheet" href="/assets/css/0.styles.e0e4cea7.css"><style data-vue-ssr-id="data-v-3ea4e60c_0">.bi{fill:currentColor;width:1em;height:1em;font-size:1em;margin-bottom:.125em;vertical-align:middle}.bi--variant-success{color:var(--bs-success)}.bi--variant-warning{color:var(--bs-warning)}.bi--variant-danger{color:var(--bs-danger)}.bi--variant-info{color:var(--bs-info)}.bi--variant-primary{color:var(--bs-primary)}.bi--variant-secondary{color:var(--bs-secondary)}.bi--variant-dark{color:var(--bs-dark)}.bi--variant-light{color:var(--bs-light)}.bi--size-sm{font-size:.75em}.bi--size-md{font-size:1.25rem}.bi--size-lg{font-size:1.33333333rem}.bi--size-2x{font-size:2rem}.bi--size-3x{font-size:3rem}.bi--size-4x{font-size:4rem}.bi--size-5x{font-size:5rem}.bi--animation-cylon{animation:bi-animation-cylon .75s ease-in-out infinite alternate}.bi--animation-cylon-vertical{animation:bi-animation-cylon-vertical .75s ease-in-out infinite alternate}.bi--animation-fade{animation:bi-animation-fade .75s ease-in-out infinite alternate}.bi--animation-spin{animation:bi-animation-spin 2s linear infinite normal}.bi--animation-spin-reverse{animation:bi-animation-spin 2s linear infinite reverse}.bi--animation-spin-pulse{animation:bi-animation-spin 1s steps(8) infinite normal}.bi--animation-spin-reverse-pulse{animation:bi-animation-spin 1s steps(8) infinite reverse}.bi--animation-throb{animation:bi-animation-throb .75s ease-in-out infinite alternate}@keyframes bi-animation-cylon{0%{transform:translateX(-25%)}100%{transform:translateX(25%)}}@keyframes bi-animation-cylon-vertical{0%{transform:translateY(25%)}100%{transform:translateY(-25%)}}@keyframes bi-animation-fade{0%{opacity:.1}100%{opacity:1}}@keyframes bi-animation-spin{0%{transform:rotate(0)}100%{transform:rotate(359deg)}}@keyframes bi-animation-throb{0%{opacity:.5;transform:scale(.5)}100%{opacity:1;transform:scale(1)}}
</style>
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="d-flex flex-column min-vh-100"><header class="container-fluid position-relative Header"><nav class="navbar navbar-expand-sm navbar-dark"><div class="container-lg"><a href="/" class="NavLink navbar-brand"><img src="https://cdn.dvuckovic.com/images/avatar.png" alt="Dusan’s Space" title="Dusan’s Space" height="32" class="d-block position-relative"></a> <button type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation" class="navbar-toggler"><svg class="bi bi--size-lg"><g transform="" transform-origin="center"><use xlink:href="/assets/img/bootstrap-icons.982100e4.svg#list"></use></g></svg></button> <div id="navbar" class="collapse navbar-collapse"><ul role="menu" class="navbar-nav align-items-end me-auto text-uppercase"><li role="menuitem" class="position-relative nav-item"><a href="/tag/post/" class="NavLink nav-link">
                            Posts
                        </a></li><li role="menuitem" class="position-relative nav-item"><a href="/tag/project/" class="NavLink nav-link">
                            Projects
                        </a></li><li role="menuitem" class="position-relative nav-item"><a href="/tag/photo/" class="NavLink nav-link">
                            Photos
                        </a></li><li role="menuitem" class="position-relative nav-item"><a href="/tag/panorama/" class="NavLink nav-link">
                            Panoramas
                        </a></li></ul> <ul class="navbar-nav justify-content-end align-items-end Header__Nav__Right"><li class="nav-item"><div class="search-box pe-4"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div></li> <li class="nav-item"><a href="/rss.xml" title="Feed" class="Feed pe-4"><svg class="bi bi--size-md"><g transform="" transform-origin="center"><use xlink:href="/assets/img/bootstrap-icons.982100e4.svg#rss-fill"></use></g></svg></a></li> <li class="nav-item"><a href="https://instagram.com/dvuckovic82" target="_blank" rel="noopener noreferrer" title="Instagram" class="NavLink NavLink--External position-relative d-block pe-4"><svg class="bi bi--size-md"><g transform="" transform-origin="center"><use xlink:href="/assets/img/bootstrap-icons.982100e4.svg#instagram"></use></g></svg></a></li><li class="nav-item"><a href="https://github.com/dvuckovic" target="_blank" rel="noopener noreferrer" title="GitHub" class="NavLink NavLink--External position-relative d-block"><svg class="bi bi--size-md"><g transform="" transform-origin="center"><use xlink:href="/assets/img/bootstrap-icons.982100e4.svg#github"></use></g></svg></a></li></ul></div></div></nav> <!----></header> <article itemscope="itemscope" itemtype="https://schema.org/BlogPosting" class="container-lg px-3 Post GlobalLayout"><div class="row justify-content-center"><header id="header" class="col-md-9 Post__Header"><ul itemprop="keywords" class="d-flex flex-row mb-2 list-unstyled Post__Meta Post__Meta--Tags"><li class="text-uppercase PostTag"><a href="/tag/post" class="me-3"><span>
            post
        </span></a></li><li class="text-uppercase PostTag"><a href="/tag/windows" class="me-3"><span>
            windows
        </span></a></li><li class="text-uppercase PostTag"><a href="/tag/script" class="me-3"><span>
            script
        </span></a></li><li class="text-uppercase PostTag"><a href="/tag/dtp" class="me-3"><span>
            dtp
        </span></a></li><li class="text-uppercase PostTag"><a href="/tag/color" class="me-3"><span>
            color
        </span></a></li></ul> <h1 itemprop="name headline" class="Post__Title">
                Color calibration and dual monitor setup in Windows 7
            </h1> <p itemprop="description" class="mt-4 mb-4 Post__Summary">
                Getting around a buggy system implementation
            </p> <footer><!----> <div class="text-uppercase Post__Meta Post__Meta--Date"><time itemprop="datePublished" datetime="2011-11-28T00:00:00.000Z">
                        2011-11-28
                    </time> <span class="mx-2">
                            •
                        </span>
                        15 minutes
                    </div></footer></header></div> <div class="row"><figure class="col Post__FullImage"><img src="https://cdn.dvuckovic.com/posts/calibration-01_header.jpg" alt="Color calibration and dual monitor setup in Windows 7" sizes="(max-width: 800px) 400px, (max-width: 1170px) 1170px, 2000px" class="rounded w-100"></figure></div> <div class="row justify-content-center"><section itemprop="articleBody" class="col-md-9"><div class="Post__Content content__default"><p>Given the nature of my professional calling, I depend on properly calibrated monitors, since you can only rely so much on your experience when there are choices to be made concerning the color. While the eyedropper tool is indeed a godsend, calibration is a must in an environment where photo manipulation is in the play, which is nowadays very common. Add two or more monitors in the mix, and suddenly things don’t work as they are supposed to.</p> <h2 id="the-setup"><a href="#the-setup" class="Permalink">#</a> The setup</h2> <p>I have a dual monitor setup at home, with a primary 5:4 panel used mainly for work/browsing and a secondary 16:10 panel for media/home theater thingy. I calibrated both of them using a third party system, obtaining appropriate ICC profiles for each. Window 7 finally did some much needed overhauling in the color management department, sporting new Color Management control panel. Even handy quick-n-dirty calibration is available using simple wizard, which can give you somewhat accurate results.</p> <p>I mainly use one display at a time, but I often switch from one to another. They are even on a different walls of the room, and not exactly intended for Cloned or Extended Desktop. As I calibrated both of them, I expected each of them to be using a different profile for calibration. But, here comes the problem.</p> <h2 id="the-problem"><a href="#the-problem" class="Permalink">#</a> The problem</h2> <p>I noticed this bug in XP, Vista and, unfortunately, Windows 7. If you have a dual head video card, dual monitors and different calibration for each of them, Windows will let you define appropriate profiles, and even load them on the first use (e.g. first user log-on). But, if you happen to switch the display from one or another, for example to watch some movies on a second monitor, and then continue working on the first one, things go awry.</p> <p>I had different results with different setups, but Windows don’t seem to load appropriate profile each time you switch displays. Sometimes the wrong profile remains active (in the LUT in the card), usually the first one remains active, resulting in wrong color calibration on active display. You may then want to go back to the original display, and sometimes things go alright (original profile remains active), but sometimes the calibration simply vanishes!</p> <p>In XP I used third party calibration loader, executed each start-up. When switching display, I needed to run it again, and things sometimes would fix themselves, sometimes not. It was a frustrating experience 😃</p> <p><img src="https://cdn.dvuckovic.com/posts/calibration-02.jpg#nozoom" alt="Example of wrong calibration profile loaded"></p> <p>So I was disappointed to learn that Windows 7 suffered from the same flaw. I even reproduced the problem when waking up the computer from stand by mode. Since going back to the third party software for color management was out of the question, I decided to stick with built-in and was forced to reload calibration from the control panel each time I switched the monitors.</p> <p>Somehow the option to reload calibration is missing from the otherwise-packed Windows 7 shell commands. The <em>only</em> way to force reloading is either going to the control panel, or a system restart.</p> <h2 id="the-fix"><a href="#the-fix" class="Permalink">#</a> The fix</h2> <p>So I started looking for a fix. On many support forums poor video drivers are blamed, emphasizing the fact that driver providers had this problem for many years without a fix. But I don’t think that is the case: things obviously work, otherwise there wouldn’t be profile loading at all. It seems to me that the system color management is to blame, specifically the lack of proper triggers for profile loading.</p> <p>Looking for an answer, I stumbled upon an interesting new service in Windows 7: Trigger Start! Actually, it’s not a new service, it’s just an added functionality in regular Task Scheduler. But here is the fun part: it’s event based! Basically you can define a task to run based on a certain system trigger (e.g. event). By diving in the Task Scheduler administration console you can deduce that most system tasks are set up this way. Awesome!</p> <p><img src="https://cdn.dvuckovic.com/posts/calibration-03.jpg#nozoom" alt="Windows 7 Task Scheduler console"></p> <p>Reading through them I found the one responsible for reloading calibration profiles! It’s conspicuously named &quot;Calibration Loader&quot; 😃 By going in it’s properties you can see it’s activated only on certain triggers, both of them dealing with the basically same thing: user log-on!</p> <p><img src="https://cdn.dvuckovic.com/posts/calibration-04.jpg#nozoom" alt="Calibration Loader Properties"></p> <p>So only if we can add another trigger suitable for our case: switching displays. Enter a handy command line utility.</p> <h3 id="displayswitch"><a href="#displayswitch" class="Permalink">#</a> DisplaySwitch</h3> <p><em>UPDATE: Originally, I didn’t test Extended Desktop option, since I’m not using it often. But it’s good one to have, so I added a switch for this too, take a look below.</em></p> <p><code>DisplaySwitch</code> is a small utility which is responsible for bringing up the display switching dialog in Windows 7, using the <em>Win+P</em> shortcut. But it also has command line mode via arguments, in order to switch displays programmatically. It’s working surprisingly well, but with a caveat. It does not raise a trigger necessary for Task Scheduler job.</p> <p>But we can use another utility to do this at the same time when calling DisplaySwitch. Below is a simple script in Visual Basic Scripting language, which can be natively executed on Windows. Simply paste it in a text file with .VBS extension and you are set:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Set</span> WshShell <span class="token operator">=</span> WScript<span class="token punctuation">.</span>CreateObject<span class="token punctuation">(</span><span class="token string">&quot;WScript.Shell&quot;</span><span class="token punctuation">)</span>
WshShell<span class="token punctuation">.</span>Run <span class="token string">&quot;C:\Windows\System32\DisplaySwitch.exe /external&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span>
WshShell<span class="token punctuation">.</span>Run <span class="token string">&quot;eventcreate /l System /t INFORMATION /so DisplaySwitch /id 200 /d &quot;&quot;Switching display...&quot;&quot;&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span>
</code></pre></div><p>This is fairly simple, but let’s take a look at it. Second command executes <code>DisplaySwitch</code> utility with an <code>/external</code> argument in order to activate the external display. Third line uses <code>eventcreate</code> command to log a System event for the previous action. Easy, right?</p> <p>You can reverse the <code>DisplaySwitch</code> command and here is the .VBS script for making the primary monitor active:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Set</span> WshShell <span class="token operator">=</span> WScript<span class="token punctuation">.</span>CreateObject<span class="token punctuation">(</span><span class="token string">&quot;WScript.Shell&quot;</span><span class="token punctuation">)</span>
WshShell<span class="token punctuation">.</span>Run <span class="token string">&quot;C:\Windows\System32\DisplaySwitch.exe /internal&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span>
WshShell<span class="token punctuation">.</span>Run <span class="token string">&quot;eventcreate /l System /t INFORMATION /so DisplaySwitch /id 200 /d &quot;&quot;Switching display...&quot;&quot;&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span>
</code></pre></div><p>And for Extended Desktop version, a separate switch:</p> <div class="language-vb extra-class"><pre class="language-vb"><code><span class="token keyword">Set</span> WshShell <span class="token operator">=</span> WScript<span class="token punctuation">.</span>CreateObject<span class="token punctuation">(</span><span class="token string">&quot;WScript.Shell&quot;</span><span class="token punctuation">)</span>
WshShell<span class="token punctuation">.</span>Run <span class="token string">&quot;C:\Windows\System32\DisplaySwitch.exe /extend&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span>
WshShell<span class="token punctuation">.</span>Run <span class="token string">&quot;eventcreate /l System /t INFORMATION /so DisplaySwitch /id 200 /d &quot;&quot;Switching display...&quot;&quot;&quot;</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token boolean">TRUE</span>
</code></pre></div><h3 id="new-trigger"><a href="#new-trigger" class="Permalink">#</a> New trigger</h3> <p>Now we can go back to the Calibration Loader Properties dialog and define new trigger for it. Click New... and add a basic trigger like on a screenshot below.</p> <p><img src="https://cdn.dvuckovic.com/posts/calibration-05.jpg#nozoom" alt="Adding a new trigger"></p> <p>New trigger starts the task &quot;On an event&quot; logged under &quot;System&quot; with a source set to &quot;DisplaySwitch&quot; and with an ID of &quot;200&quot; (all OK).</p> <p>Now you can define shortcuts for each of the .VBS script and conveniently place them on a toolbar of choice. Clicking appropriate shortcut will switch your display, raise the event, and Calibration Loader will do the rest. Voilà!</p> <p><img src="https://cdn.dvuckovic.com/posts/calibration-06.jpg#nozoom" alt="Trigger shortcut"></p> <p>This is a very simple fix, using only built in tools, and I wonder why things like this haven’t been fixed already? Considering that a dual monitor setup is common among professionals (which should be calibrated), it’s very likely this problem is widespread.</p></div></section></div> <div class="row"><section itemprop="articleBody" class="col"><div class="Post__Content content__wide"></div></section></div> <div class="Sticker d-none d-xxl-block Toc position-fixed Toc" style="opacity:0;"><div class="Toc__Item Toc__H1"><a href="#app" title="Color calibration and dual monitor setup in Windows 7">
            Color calibration and dual monitor setup in Windows 7
        </a></div> <div class="Toc__Item Toc__H2 Toc__Item--Active"><a href="#the-setup" title="The setup">
            The setup
        </a></div><div class="Toc__Item Toc__H2"><a href="#the-problem" title="The problem">
            The problem
        </a></div><div class="Toc__Item Toc__H2"><a href="#the-fix" title="The fix">
            The fix
        </a></div><div class="Toc__Item Toc__H3"><a href="#displayswitch" title="DisplaySwitch">
            DisplaySwitch
        </a></div><div class="Toc__Item Toc__H3"><a href="#new-trigger" title="New trigger">
            New trigger
        </a></div></div></article> <footer class="container-fluid flex-grow-1 Footer"><div class="container-lg my-3"><div class="row align-items-center"><div class="col-lg-3 order-3 order-lg-1"><ul role="menu" class="d-flex flex-row justify-content-center justify-content-lg-start m-0 list-unstyled"><li role="menuitem" class="Footer__Nav__Item"><a href="/" class="NavLink">
                            © 2021 Dusan Vuckovic
                        </a></li></ul></div> <div class="col-lg-6 order-2 mt-1 mb-2 mb-lg-0 Footer__Center"><ul role="menu" class="d-flex flex-wrap justify-content-center m-0 list-unstyled"><li role="menuitem" class="mb-1 me-1 Footer__Nav__Item"><a href="https://vuepress.vuejs.org" target="_blank" class="NavLink NavLink--External"><img src="https://img.shields.io/badge/powered_by-VuePress-3eaf7c?logo=Vue.js" alt="Powered by VuePress"></a></li><li role="menuitem" class="mb-1 me-1 Footer__Nav__Item"><a href="https://www.cloudflare.com" target="_blank" class="NavLink NavLink--External"><img src="https://img.shields.io/badge/secured_by-Cloudflare-f38020?logo=cloudflare" alt="Secured by Cloudflare"></a></li><li role="menuitem" class="mb-1 me-1 Footer__Nav__Item"><a href="http://www.wtfpl.net" target="_blank" class="NavLink NavLink--External"><img src="https://img.shields.io/badge/license-WTFPL-white" alt="Licensed as WTFPL"></a></li></ul></div> <div class="col-lg-3 order-1 order-lg-3 mb-2 mb-lg-0"><ul role="menu" class="d-flex flex-row justify-content-center justify-content-lg-end m-0 list-unstyled"><li role="menuitem" class="Footer__Nav__Item"><a href="#email-modal" data-bs-toggle="modal" class="NavLink NavLink--External">
                            Email
                        </a></li><li role="menuitem" class="Footer__Nav__Item"><a href="/privacy-policy.html" class="NavLink">
                            Privacy
                        </a></li><li role="menuitem" class="Footer__Nav__Item"><a href="https://github.com/dvuckovic" target="_blank" class="NavLink NavLink--External">
                            Github
                        </a></li></ul></div></div></div></footer> <div id="email-modal" tabindex="-1" aria-hidden="true" class="modal fade"><div class="modal-dialog modal-dialog-centered"><div class="modal-content"><div class="modal-header"><h2 class="modal-title">Hey there!</h2></div> <div class="modal-body"><p>The best way to get in touch with me directly is to drop me an email.</p>
<p>My email address is my <strong>given name</strong> at this website.</p>
<p><em>If you want to send me a secure message, you can get <a href="https://cdn.dvuckovic.com/downloads/dvuckovic.crt" class="NavLink NavLink--PublicKey" download>my S/MIME certificate</a>.</em></p><p><small><em>Or, if you prefer PGP, get <a href="https://cdn.dvuckovic.com/downloads/dvuckovic.pub" class="NavLink NavLink--PublicKey" download>my public key</a>.</em></small></p></div> <div class="modal-footer"><button type="button" data-bs-dismiss="modal" class="btn btn-primary">Got it!</button></div></div></div></div></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.7a75f1fe.js" defer></script><script src="/assets/js/19.1346b3bf.js" defer></script><script src="/assets/js/12.e1236284.js" defer></script><script src="/assets/js/38.6c805e13.js" defer></script>
  </body>
</html>
